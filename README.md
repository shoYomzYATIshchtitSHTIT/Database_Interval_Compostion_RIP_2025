#### Лабораторная 4

- **Цель работы**: Завершение бэкенда для `SPA`
- **Порядок показа**: выполнить метод аутентификации через `swagger` в режиме инкогнито, получить список заявок в `swagger`; из браузера использовать содержимое `куки` из вкладки `Application` или `JWT` из ответа аутентификации для заголовков `cookie` или `authorization` соответственно в остальных запросах через `insomnia`/`postman`. Далее в `insomnia`/`postman` выполнить GET списка заявок: 401/403 для гостя, для создателя только его заявки. Выполнить PUT завершения заявки: для создателя 403 статус, для модератора успех и обновление полей. Выполнить GET списка заявок - для модератора все заявки. Показать содержимое `Redis` через `cmd`, для сессий показать пользователя
- **Контрольные вопросы**: куки, сессия, Redis, JWT, авторизация и аутентификация, SSO, двухфакторная аутентификаци, RSA
- **Sequence диаграмма**: весь набор `HTTP` запросов по бизнес-процессу без БД и нативного приложения: аутентификация, список услуг, GET пустой иконки корзины, добавление услуги в заявку, GET иконки корзины, просмотр черновой заявки, редактирование заявки, формирование заявки, список заявок, завершение модератором из второго фронтенда, список заявок с расчетом. Добавить домены в качестве `Lifeline`, при добавлении сообщений выбирать методы доменов из диаграммы классов, передавать ключевые входные и выходные данные через `arguments` в скобках у `Message`
- **Задание**: Добавление авторизации и `swagger` в веб-сервис, подготовка ТЗ

Реализовать методы бэкенда для `аутентификации` и `регистрации`. Авторизация через хранение сессий и куки. Автозаполнение пользователя в таблице `заявок` при создании новой. Добавить описание методов для `swagger`.

Добавить проверку `Permissions` для методов `модератора`. Без авторизации в `Swagger` должно быть доступно только чтение-получение данных через API, с авторизацией - методы `пользователя`, а для `модератора` доступны все методы.

* [Методические указания](/tutorials/redis/README.md) Redis
* [Методические указания Golang JWT](/tutorials/lab4-go/README.md). Видео мастер-класс [Авторизация, Swagger и Redis на Golang](https://vk.com/video-211704031_456239169)
* [Методические указания DRF Сессии](/tutorials/lab4-py/README.md). Видео мастер-класс [Авторизация на Django](https://vk.com/video-211704031_456239170)

Вместе с 4 лабораторной сдается текущий комплект документации, который требуется оформить в виде `.doc`:
- титульный лист РПЗ
- 3 диаграммы оформить как рисунки в РПЗ
- расчет аппаратных требований (число ядер, ОП, прирост БД) по количеству пользователей и rps
- Приложение 1. ТЗ как приложение к РПЗ
- Приложение 2. Таблица методы веб-сервиса

Состав **ТЗ** на итоговую систему (использовать сплошную нумерацию внутри пунктов):
1. **цель**
2. **назначение** - краткое описание для чего, кто работает в системе
3. **задачи** - 12 задач (8 лабораторных-задач по бекенду/фронтенду, нативное приложение, демо в Pages, документация, репозиторий Git) с указанием ваших технологий по каждой задаче
4. **Функциональные требования** - список HTTP методов, далее список окон и какие действия для каких групп пользователей доступны. Указать, какие методы бэкенда при этом вызываются. Всего 14 подпунктов - HTTP методы, меню и 12 страниц приложения:

* `гость`: регистрация, аутентификация, главная, список услуг, одна услуга, 403 и 404

* `создатель` заявки: страница заявки, список заявок, личный кабинет

* `модератор`: список услуг таблицей, редактирование/создание услуги

5. **требования к аппаратному** обеспечению для сервера и клиента
6. **требования к программному** обеспечению с версиями для серверных компонентов и для клиента

### Дополнительное задания ДЗ. Модуль 1 (+4 балла)

> Внести в Задачи и Заключение

#### Индексы в БД

- **Порядок показа**: показать пагинацию с фильтрацией по индексу в React-приложении. Включить и отключить индекс - показать отличие во времени запроса.

Добавить в БД большое количество (> 100000) `услуг` или `заявок` соответственно + реализовать пагинация на фронтенде и ограничение количества в методе бэкенда.

* [Индексы и план запроса](https://github.com/iu5git/Database/blob/main/tutorials/lab_index.md)